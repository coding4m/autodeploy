---

# ansible docker module pull image exists bug, use command pull instead
- name: "docker pull [swarm] images."
  command: docker pull {{item}}
  with_items:
    - 'swarm:latest'
  ignore_errors: true

- name: "docker run swarm-agent container."
  docker:
    name: swarm-agent
    image: swarm:latest
#    pull: always
    state: reloaded
    restart_policy: always
    volumes:
    - /etc/localtime:/etc/localtime:ro
    command: join --addr {{swarm_docker}} {{swarm_cluster}}
